# Тестовий план для системи відеопрокату

## Аналіз системи та ідентифікація потенційних точок відмови при високому навантаженні

### Потенційні точки відмови

#### База даних:
**Точка відмови:** Велика кількість одночасних запитів до бази даних, наприклад, одночасна оренда багатьма користувачами або перегляд каталогу фільмів, може викликати вузькі місця у виконанні транзакцій.

- **Умови відмови:**
  - Блокування транзакцій через одночасний доступ до тих самих записів.
  - Вичерпання пулу підключень до бази даних.
  - Тайм-аути через перевантаження бази даних.

- **Наслідки:** Нездатність системи завершити транзакції, затримки при обробці замовлень або неможливість обробити оренду.

#### Система оренди фільмів:
**Точка відмови:** Високий обсяг одночасних оренд фільмів або їх повернень може призвести до конфліктів транзакцій або затримок в обробці великих потоків запитів.

- **Умови відмови:**
  - Неправильне завершення транзакцій або "зависання" через великі черги.
  - Невдалі оренди через перевантаження бази даних.

- **Наслідки:** Неправильне оновлення статусу доступності фільмів або збої в обробці оренд.

#### Зовнішні API (наприклад, отримання інформації про фільми):
**Точка відмови:** При великій кількості запитів до зовнішніх API для отримання даних можуть виникати проблеми з доступністю або перевищенням лімітів запитів.

- **Умови відмови:**
  - Перевищення лімітів запитів.
  - Довгий час відповіді від API через перевантаження.

- **Наслідки:** Відсутність актуальних даних, що може призвести до незадовільного досвіду користувачів.

#### Пул підключень та HTTP-запити:
**Точка відмови:** Велика кількість одночасних запитів (наприклад, одночасне замовлення фільмів або повернення) може вичерпати пул підключень до бази даних або зовнішніх сервісів.

- **Умови відмови:**
  - Перевищення кількості одночасних підключень до бази даних або зовнішніх API.

- **Наслідки:** Нездатність обробити нові запити, сповільнення роботи системи або її повний збій.

---

## План тестування системи при навантаженні

### 1. Тестування навантаженням:
- **Мета:** Перевірити, як система поводиться при зростаючій кількості одночасних користувачів і запитів.
- **Тест:** Використати інструменти на зразок Apache JMeter або Locust для симуляції великої кількості одночасних запитів до системи.
  - Створити сценарії, де користувачі одночасно орендують, повертають та переглядають фільми.
- **Очікуваний результат:** Система повинна підтримувати певну кількість одночасних користувачів без значного зниження продуктивності або відмов.

### 2. Стрес-тестування:
- **Мета:** Перевірити, як система витримує екстремальні умови (навантаження понад очікувані межі).
- **Тест:** Поступово збільшувати кількість запитів до системи і спостерігати, коли почнуться відмови.
  - Імітувати великі навантаження на базу даних.
- **Очікуваний результат:** Визначити точку, в якій система починає відмовляти (наприклад, збільшення затримки або повний збій).

### 3. Тестування пулу підключень:
- **Мета:** Перевірити, як система керує пулом підключень для бази даних і зовнішніх сервісів.
- **Тест:** Створити навантаження, яке викликає багато одночасних запитів до бази даних або API.
- **Очікуваний результат:** Система повинна ефективно керувати пулом підключень без відмов.

### 4. Тестування відмов зовнішніх API:
- **Мета:** Перевірити стійкість системи в разі відмови або недоступності зовнішніх API.
- **Тест:** Імітувати недоступність або затримку відповіді зовнішніх API.
- **Очікуваний результат:** Система повинна коректно обробляти відмови API, повідомляючи користувача про помилки без зависання або збою.

---

## Документація протоколів тестів

| Тест | Опис | Очікуваний результат | Результат |
|------|------|-----------------------|-----------|
| Тест навантаження для оренди фільмів | Одночасна оренда 100 фільмів | Система обробляє всі запити без відмов, мінімальні затримки | Успіх / Відмова |
| Стрес-тест для бази даних | Збільшити кількість одночасних запитів до 500 | Час обробки запитів не перевищує заданий поріг | Успіх / Відмова |
| Відмова зовнішніх API | Імітувати недоступність API | Система коректно обробляє відмови, без заморожування | Успіх / Відмова |

---

## Пояснення рішень:
- Якщо система не може обробити запити в межах визначеного часу (наприклад, більше 2 секунд), потрібно оптимізувати обробку запитів до бази даних або управління пулом підключень.
- У разі відмов зовнішніх API, система повинна або використовувати кешовані дані, або інформувати користувача про тимчасову недоступність сервісу.

## Висновок:
Дотримуючись цього плану, можна оцінити стабільність системи при високому навантаженні та забезпечити її надійність при одночасному використанні багатьма користувачами. Тестування дозволить виявити потенційні вузькі місця і підвищити стійкість системи.

